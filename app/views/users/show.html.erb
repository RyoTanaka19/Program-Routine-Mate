<div class="flex flex-col md:flex-row justify-center items-start gap-6 max-w-7xl mx-auto px-6 py-8">
  
  <!-- プロフィールセクション（左側） -->
  <div class="flex-1 max-w-2xl w-full bg-white p-6 rounded-lg shadow-lg">
    <h1 class="text-3xl font-semibold text-center mb-6 text-green-500">プロフィール</h1>

    <div class="login-status mb-6 text-center">
      <% if user_signed_in? && current_user == @user %>
        <span class="text-green-600 font-semibold">✅ ログイン中</span>
      <% else %>
        <span class="text-red-600 font-semibold">❌ 未ログイン</span>
      <% end %>
    </div>

    <!-- ユーザーアイコン -->
    <div class="flex justify-center mb-6">
      <%= link_to user_path(@user), class: "flex items-center" do %>
        <%= image_tag(@user.profile_image.present? ? @user.profile_image.url : "default_study_logs_image.png", class: "w-24 h-24 rounded-full object-cover shadow-lg") %>
      <% end %>
    </div>
    
    <!-- ユーザー名 -->
    <div class="mb-6">
      <h3 class="text-xl font-semibold text-gray-700">ユーザー名</h3>
      <p class="text-gray-600 bg-gray-100 p-4 rounded-lg mt-2 text-center"><%= @user.name %></p>
    </div>

    <!-- メールアドレス（現在のユーザーのみ表示） -->
    <% if user_signed_in? && current_user == @user %>
      <div class="mb-6">
        <h3 class="text-xl font-semibold text-gray-700">メールアドレス</h3>
        <p class="text-gray-600 bg-gray-100 p-4 rounded-lg mt-2 text-center"><%= @user.email %></p>
      </div>
    <% end %>

    <!-- 自己紹介 -->
    <div class="mb-6">
      <h3 class="text-xl font-semibold text-gray-700">自己紹介</h3>
      <p class="text-gray-600 bg-gray-100 p-4 rounded-lg mt-2"><%= @user.self_introduction %></p>
    </div>

    <!-- プロフィール編集リンク（現在のユーザーのみ表示） -->
    <% if user_signed_in? && current_user == @user %>
      <div class="text-center mt-8">
        <%= link_to "プロフィールの編集", edit_user_registration_path, class: "text-green-500 hover:underline font-semibold" %>
      </div>
    <% end %>
  </div>

  <!-- 投稿セクション（右側）※自分だけに表示 -->
  <% if user_signed_in? %>
    <div class="flex-1 max-w-2xl w-full bg-white p-6 rounded-lg shadow-lg">
      <h2 class="text-2xl font-semibold text-center mb-6 text-yellow-600"><%= @user.name %>さんの投稿</h2>

      <% if @study_logs.any? %>
        <ul class="space-y-4">
          <% @study_logs.each do |study_log| %>
            <li class="bg-gray-100 p-4 rounded-md shadow-sm hover:bg-gray-200 transition">
              <%= link_to study_log.content, study_log_path(study_log), class: "text-yellow-600 font-semibold hover:underline" %>
            </li>
          <% end %>
        </ul>
      <% else %>
        <p class="text-center text-gray-600">まだ投稿がありません。</p>
      <% end %>
    </div>
  <% end %>

<!-- 友だち追加ボタン（投稿セクションの下） -->
<div class="flex flex-col items-center w-20 mt-8">
  <button id="friend-image" class="relative">
    <%= image_tag("friend.png", alt: "友だち追加", class: "cursor-pointer mx-auto w-16 h-16") %> <!-- 画像を少し大きく -->
  </button>
  <span class="mt-1 text-xs text-white text-center">友だち追加</span>
  <!-- LINE友達追加の文言を追加 -->
  <span class="mt-2 text-sm text-green-600 text-center">LINE友だち追加</span>
</div>

  
</div>

<!-- モーダル -->
<div id="friend-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center">
  <div class="bg-white p-8 rounded-lg shadow-lg w-72 max-w-xs">
    <div class="flex flex-col items-center">
      <%= image_tag("line_friend.png", alt: "LINE友だち追加QRコード", class: "mx-auto w-32 h-32") %>
      <div id="thank-you-message" class="mt-4 text-[#00C300] text-lg font-semibold hidden animate-fade-in">
        友だち申請ありがとう!!
      </div>
      <button id="close-modal" class="mt-4 px-4 py-2 bg-green-600 text-white rounded-full">
        閉じる
      </button>
    </div>
  </div>
</div>

<style>
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .animate-fade-in {
    animation: fadeIn 0.8s ease-out forwards;
  }

  #thank-you-message { color: #00C300; }

  /* モーダルの背景を暗くする */
  #friend-modal {
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: rgba(0, 0, 0, 0.5); /* 背景を暗く */
  }

  /* モーダルの非表示 */
  #friend-modal.hidden {
    display: none;
  }
</style>

<script>
  // 友だち追加画像をクリックしたときの処理
  document.getElementById("friend-image").addEventListener("click", function() {
    const modal = document.getElementById("friend-modal");
    const message = document.getElementById("thank-you-message");

    // モーダルを表示
    modal.classList.remove("hidden");
    
    // メッセージを表示
    message.classList.remove("hidden");
    message.classList.remove("animate-fade-in");
    void message.offsetWidth;  // アニメーションのリセット
    message.classList.add("animate-fade-in");
  });

  // モーダルを閉じるボタンの処理
  document.getElementById("close-modal").addEventListener("click", function() {
    const modal = document.getElementById("friend-modal");
    
    // モーダルを非表示にする
    modal.classList.add("hidden");
  });

  // モーダルの背景部分をクリックしたときにモーダルを閉じる処理
  document.getElementById("friend-modal").addEventListener("click", function(event) {
    if (event.target === this) {
      const modal = document.getElementById("friend-modal");
      modal.classList.add("hidden");
    }
  });
</script>
