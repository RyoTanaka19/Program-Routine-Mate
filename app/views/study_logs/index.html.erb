<h1 class="text-center text-7xl">投稿一覧画面</h1>
<% if current_user %> <!-- current_userがnilでない場合に表示 -->
      <%= link_to image_tag("icon.png", class: "w-16 h-16 rounded-full shadow-md hover:shadow-lg transition"), user_badges_path(current_user) %>
  <% end %>
<br>
<%= render 'search_form', q: @q, url: study_logs_path %>
<br>

<div class="flex flex-col items-center mb-6">
  <%= link_to image_tag("crown.png", class: "w-16 h-16 rounded-full shadow-md hover:shadow-lg transition"), ranking_study_logs_path %>

  <div class="flex space-x-4 mt-4 overflow-x-auto">
    <% @ranking.each_with_index do |ranking, index| %>
      <% user = User.find(ranking[:user_id]) %>
      <div class="flex flex-col items-center bg-gray-50 p-4 rounded-lg shadow-md hover:bg-gray-200 w-24">
        <div class="text-center bg-yellow-200 font-semibold w-12 h-12 flex items-center justify-center rounded-full">
          <%= index + 1 %>
        </div>
        <div class="mt-2 text-center font-medium">
          <%= user.name %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<br>
<br>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

<div class="flex flex-wrap gap-4">
  <% @study_logs.each do |study_log| %>
    <div class="w-80 mb-3">
      <div class="border p-4">
        <p>投稿者: <%= study_log.user&.name || "ユーザー情報なし" %></p>
        <p><strong>投稿日:</strong> <%= study_log.created_at.strftime("%Y年%m月%d日 %H:%M") %></p>
        <br>
        <p>学習内容: <%= link_to study_log.content, study_log_path(study_log), class: "text-blue-500 hover:underline" %></p>
        <br>
        <p><%= image_tag(study_log.image? ? study_log.image_url : "default_study_logs_image.png", width: "300", height: "200") %></p>
        <p> 感想など: <%= study_log.text %></p>

        <br>

        <div class="login-status">
          <% if user_signed_in? && current_user == study_log.user %>
            <span style="color: green;">✅ ログイン中</span>
          <% else %>
             <span style="color: red;">❌ 未ログイン</span>
          <% end %>
        </div>

        <% if user_signed_in? && study_log.user_id == current_user.id %>
          <!-- 編集ボタン -->
          <%= link_to edit_study_log_path(study_log), id: "button-edit-#{study_log.id}", class: "inline-flex items-center px-4 py-2 bg-blue-500 text-white font-semibold rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-300" do %>
          <i class="fas fa-pencil-alt w-2 h-4 mr-2"></i>
          <% end %>
          <!-- 削除ボタン -->
          <%= link_to study_log_path(study_log), data: { turbo_method: :delete, turbo_confirm: "本当に削除しますか?" }, id: "button-delete-#{study_log.id}", class: "inline-flex items-center px-4 py-2 bg-red-500 text-white font-semibold rounded-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-300" do %>
          <i class="fas fa-trash w-2 h-4 mr-2"></i>
          <% end %>
        <% end %>
      </div>
    </div>
  <% end %>
</div>